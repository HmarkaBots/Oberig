from aiogram import Bot
from aiogram.types import Message
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.types import ReplyKeyboardRemove
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import StatesGroup, State
import re
from dotenv import load_dotenv
from aiogram.types import Message
from aiogram.fsm.context import FSMContext
import os
from db import BotDB
from aiogram.fsm.state import State, StatesGroup


load_dotenv("dev.env")
db = BotDB(os.getenv("DB_NAME"))


class RegisterState(StatesGroup):
    regName = State()
    regPhone = State()


register_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [
            KeyboardButton(
                text='üü¢–°–¢–ê–†–¢ –ë–û–¢–£üü¢'
            )
        ]
    ],
    resize_keyboard=True,
    one_time_keyboard=True,
    input_field_placeholder="–î–ª—è –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è –Ω–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ üëá"
)

async def get_start(message: Message, bot: Bot):
    await bot.send_message(
        message.from_user.id,
        text=(
            f"–í—ñ—Ç–∞—î–º–æ –≤ –ë–æ—Ç—ñ! –î—è–∫—É—î–º–æ –∑–∞ –±–∞–∂–∞–Ω–Ω—è –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞—Å‚ù§Ô∏è!\n"
            f"–ë–æ—Ç –¥–æ–ø–æ–º–æ–∂–µ —Ç–æ–±—ñ –ø—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ –∑–±–æ—Ä—É \n\n\n"
        ), reply_markup=register_keyboard
    )

async def start_register(message: Message, state: FSMContext):
    await message.answer(
        f"‚≠ê –ü–æ—á–Ω–µ–º–æ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é! ‚≠ê\n"
        f"–°–ø–µ—Ä—à—É –Ω–∞–ø–∏—à–∏ —è–∫ –¥–æ —Ç–µ–±–µ –º–æ–∂–Ω–∞ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è?",
        reply_markup=ReplyKeyboardRemove()  # –í–∏–¥–∞–ª—è—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É
    )
    await state.set_state(RegisterState.regName)

async def name_register(message: Message, state: FSMContext):
    await message.answer(
        f"üòä –ü—Ä–∏—î–º–Ω–æ –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è, {message.text}\n"
        f"üì± –¢–µ–ø–µ—Ä –≤–∫–∞–∂–∏ —Å–≤—ñ–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É, –∞–±–æ –ø–æ–¥—ñ–ª–∏—Å—è —Å–≤–æ—ó–º –∫–æ–Ω—Ç–∞–∫—Ç–æ–º, —â–æ–± –∑–∞–≤–µ—Ä—à–∏—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é \n"
        f"‚úÖ –¶–µ –¥–æ–ø–æ–º–æ–∂–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏, —â–æ —Ç–∏ –Ω–µ –±–æ—Ç, –∞ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π –Ø–Ω–≥–æ–ª, –≥–æ—Ç–æ–≤–∏–π —Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏–≤–∞ \n\n"
        f"‚ö†Ô∏è –£–≤–∞–≥–∞! –§–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω—É –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫: +380********* \n\n",
        reply_markup=share_phone_keyboard  # –î–æ–¥–∞—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑ –∫–Ω–æ–ø–∫–æ—é "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –Ω–æ–º–µ—Ä–æ–º"
    )
    await state.update_data(regname=message.text)
    await state.set_state(RegisterState.regPhone)

# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –Ω–æ–º–µ—Ä–æ–º"
share_phone_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [
            KeyboardButton(
                text="üì± –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –Ω–æ–º–µ—Ä–æ–º",
                request_contact=True
            )
        ]
    ],
    resize_keyboard=True,
    one_time_keyboard=True,
    input_field_placeholder="–í–≤–µ–¥–∏ –Ω–æ–º–µ—Ä –∞–±–æ –ø–æ–¥—ñ–ª–∏—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º"
)

# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –∞–±–æ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É
async def ask_for_phone(message: Message, state: FSMContext):
    await message.answer(
        text="–ë—É–¥—å –ª–∞—Å–∫–∞, –ø–æ–¥—ñ–ª–∏—Å—è —Å–≤–æ—ó–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω—É –∞–±–æ –≤–≤–µ–¥–∏ –π–æ–≥–æ —É —Ñ–æ—Ä–º–∞—Ç—ñ +380XXXXXXXXX:",
        reply_markup=share_phone_keyboard  # –î–æ–¥–∞—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É
    )
    await state.set_state(RegisterState.regPhone)


# –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∞–±–æ –∫–æ–Ω—Ç–∞–∫—Ç—É
async def register_phone(message: Message, state: FSMContext):
    db = BotDB(os.getenv("DB_NAME"))  # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î
    try:
        # –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–¥—ñ–ª–∏–≤—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º
        if message.contact:
            phone_number = message.contact.phone_number
            await state.update_data(regphone=phone_number)
        # –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤—ñ–≤ –Ω–æ–º–µ—Ä –≤—Ä—É—á–Ω—É
        elif re.match(r"^\+380\d{9}$", message.text):
            await state.update_data(regphone=message.text)
        else:
            await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –∞–±–æ —Å–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ—é.")
            return  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ—Å—è –±–µ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
        reg_data = await state.get_data()
        reg_name = reg_data.get('regname')
        reg_phone = reg_data.get('regphone')

        # –î–æ–¥–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É –±–∞–∑—É –¥–∞–Ω–∏—Ö
        db.add_user(message.from_user.id, reg_name, reg_phone)

        # –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —É—Å–ø—ñ—à–Ω—É —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é
        msg = f"‚úÖ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø—ñ—à–Ω–æ! –¢–∏ –≤–∂–µ —á–∞—Å—Ç–∏–Ω–∞ –Ω–∞—à–æ—ó —Ä—ñ–∑–¥–≤—è–Ω–æ—ó —ñ—Å—Ç–æ—Ä—ñ—ó!\nüåü –¢–≤–æ—è —É—á–∞—Å—Ç—å –∑–º—ñ–Ω—é—î —Å–≤—ñ—Ç\n–Ü–º'—è: {reg_name}, –¢–µ–ª–µ—Ñ–æ–Ω: {reg_phone}"
        await message.answer(msg)

        # –û—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞–Ω—É
        await state.clear()

        # DEBUG: –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–∫–ª–∏–∫—É
        print("DEBUG: –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è about_collection")

        # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –Ω–æ–≤—É –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑ —Ç—Ä—å–æ–º–∞ –∫–Ω–æ–ø–∫–∞–º–∏
        await message.answer(
            "–û–±–µ—Ä–∏ –æ–¥–∏–Ω —ñ–∑ –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –Ω–∏–∂—á–µ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó üëá",
            reply_markup=collection_keyboard
        )

    except ValueError:
        await message.answer("‚ùó–¢–∏ –≤–∂–µ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π.")
    except Exception as e:
        await message.answer(f"‚ùå –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞: {e}")
    finally:
        db.close()
        

from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton

# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –∑ –∫–Ω–æ–ø–∫–∞–º–∏ "–ü—Ä–æ –∑–±—ñ—Ä", "–ü–∞—Ä—Ç–Ω–µ—Ä–∏" —Ç–∞ "–î–æ–ª—É—á–∏—Ç–∏—Å—å –¥–æ –ø—ñ–¥—Å–∏–ª–µ–Ω–Ω—è –∑–±–æ—Ä—É"
collection_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üì¢–ü—Ä–æ –∑–±—ñ—Ä")],
        [KeyboardButton(text="ü§ù–ü–∞—Ä—Ç–Ω–µ—Ä–∏")],
        [KeyboardButton(text="‚ú® –°—Ç–∞–≤–∞–π —á–∞—Å—Ç–∏–Ω–æ—é –¥–∏–≤–∞! ‚ú®")]
    ],
    resize_keyboard=True,
    one_time_keyboard=False
)

# –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ –∑–±—ñ—Ä"
async def about_collection(message: Message):
    await message.answer(
        text=(
            "üì¢ *–ü—Ä–æ –∑–±—ñ—Ä*\n\n"
            '''*–û–±–µ—Ä—ñ–≥ –Ω–∞ –ù–æ–≤–∏–π —Ä—ñ–∫ üéÅ* ‚Äì —Ü–µ –º–∞—Å—à—Ç–∞–±–Ω–∞ –±–ª–∞–≥–æ–¥—ñ–π–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∞, –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏ –ö–∏—î–≤–∞. –î–æ –∫–æ–º–∞–Ω–¥–∏ —ñ–Ω—ñ—Ü—ñ–∞—Ç–∏–≤–∏ –≤—Ö–æ–¥—è—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–Ω–∏–∫–∏:

    üìå–†–∞–¥–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ù–ù–Ü–ú–í
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –§–Ü–¢
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –ù–ù–Ü–ñ
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –ù–ù–Ü–ü–£–î–°
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –ï–§
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –ù–ù–Ü–ü
    üìå–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–æ–≥–æ –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—É –ù–ù–¶ ¬´–Ü–ë–ú¬ª
    üìå–ì–û ‚Äú–°—Ç—É–¥–µ–Ω—Ç—Å—å–∫–µ –ë—Ä–∞—Ç—Å—Ç–≤–æ –ö–∏—î–≤–∞‚Äù

üíôüíõ *–¶—ñ–ª—å –∑–±–æ—Ä—É: 1 000 000 –≥—Ä–∏–≤–µ–Ω—å*

    ‚ú® –ö–æ—à—Ç–∏ –±—É–¥—É—Ç—å —Å–ø—Ä—è–º–æ–≤–∞–Ω—ñ –Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫—É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª—ñ–≤:

    üìå101-—à–∞ –æ–∫—Ä–µ–º–∞ –±—Ä–∏–≥–∞–¥–∞ –æ—Ö–æ—Ä–æ–Ω–∏ –ì–® (2 –±–∞—Ç–∞–ª—å–π–æ–Ω)
    üìå1-—à–∞ –±—Ä–∏–≥–∞–¥–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ù–ì–£ ‚Äú–ë—É—Ä–µ–≤—ñ–π‚Äù
    üìå4-—Ç–∞ –±—Ä–∏–≥–∞–¥–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ù–ì–£ ‚Äú–†—É–±—ñ–∂‚Äù
    üìå–¢—Ä–µ—Ç—è –æ–∫—Ä–µ–º–∞ —à—Ç—É—Ä–º–æ–≤–∞ –±—Ä–∏–≥–∞–¥–∞
    üìå–ì–æ–ª–æ–≤–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–æ–∑–≤—ñ–¥–∫–∏

‚ú® *–ü–æ—Ç—Ä–µ–±–∏, –Ω–∞ —è–∫—ñ –∑–±–∏—Ä–∞—é—Ç—å—Å—è –∫–æ—à—Ç–∏:*

    üìå–†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ç–æ—Ä ELRS/Crossfire –∑ –∫—Ä—ñ–ø–ª–µ–Ω–Ω—è–º –Ω–∞ Mavic ‚Äì 2 –æ–¥–∏–Ω–∏—Ü—ñ
    üìå–©–æ–≥–ª–∞ ‚Äì 2 –æ–¥–∏–Ω–∏—Ü—ñ
    üìå–ù–∞–∑–µ–º–Ω–∞ —Å—Ç–∞–Ω—Ü—ñ—è ‚ÄúT-Bone V4‚Äù
    üìå–†–µ–º–æ–Ω—Ç –∞–≤—Ç—ñ–≤–∫–∏ VW T5
    üìå–ë–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π —à–æ–ª–æ–º Sestan-Busch Helmet BK-ACH-HC 
    üìå–ê–∫—Ç–∏–≤–Ω—ñ –Ω–∞–≤—É—à–Ω–∏–∫–∏ Sordin Supreme Pro-X Neckband
    üìå–ü–æ–ª–µ–≥—à–µ–Ω–∏–π –±—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç "–°–∞—Ä–º–∞—Ç" —ñ–∑ –±–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–º –ø—Ä–æ—Ç–∏—É–ª–∞–º–∫–æ–≤–∏–º –ø–∞–∫–µ—Ç–æ–º (1 –∫–ª–∞—Å—É –∑–∞—Ö–∏—Å—Ç—É, –ú–ú-14)
    üìåMavic 3T
    üìåVolkswagen Touareg 1 - 2 –æ–¥–∏–Ω–∏—Ü—ñ
    üìå–ó–∞—Ä—è–¥–Ω–∞ —Å—Ç–∞–Ω—Ü—ñ—è EcoFlow DELTA 2 Max (EFDELTA2Max-AU) AU
    üìå–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞ –∑–∞—Ä—è–¥–Ω–∞ —Å—Ç–∞–Ω—Ü—ñ—è OUKITEL P2001E PLUS (2400W 2048Wh)\n\n'''
        ),
        parse_mode="Markdown"
    )

# –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–∞—Ä—Ç–Ω–µ—Ä–∏"
async def about_partners(message: Message):
    await message.answer(
        text=(
            "ü§ù *–ü–∞—Ä—Ç–Ω–µ—Ä–∏:*\n\n"
            '''üîπ*–†—ñ–∑–¥–≤—è–Ω—ñ —ñ—Å—Ç–æ—Ä—ñ—ó*: –Ø–ª–∏–Ω–∫–æ–≤—ñ –ø—Ä–∏–∫—Ä–∞—Å–∏ –≤—ñ–¥ –±—Ä–µ–Ω–¥—É –†—ñ–∑–¥–≤—è–Ω—ñ —ñ—Å—Ç–æ—Ä—ñ—ó —Ü–µ —â–æ—Å—å, —â–æ –Ω–∞–ø–æ–≤–Ω—é—î —Å–µ—Ä—Ü–µ —Ç–µ–ø–ª–æ–º —Ç–∞ –ø—Ä–∏—î–º–Ω–∏–º–∏ —Å–ø–æ–≥–∞–¥–∞–º–∏. –©–æ—Å—å, —á–∏–º –∑–∞—Ö–æ—á–µ—Ç—å—Å—è –¥—ñ–ª–∏—Ç–∏—Å—è –∑ —Ä—ñ–¥–Ω–∏–º–∏. –ü—Ä–æ —â–æ, –∑–∞—Ö–æ—á–µ—Ç—å—Å—è —Ä–æ–∑–ø–æ–≤—ñ–¥–∞—Ç–∏ –©–æ—Å—å, —â–æ –∑–∞—Ö–æ—á–µ—Ç—å—Å—è –±–µ—Ä–µ–≥—Ç–∏ –¥–æ–≤–≥—ñ —Ä–æ–∫–∏.\n\n'''
            '''üîπ*FIRERABBIT*: –Ü–¥–µ—è –±—Ä–µ–Ω–¥—É FIRERABBIT –∑–∞—Ä–æ–¥–∏–ª–∞—Å—è –≤–æ—Å–µ–Ω–∏ 2022 —Ä–æ–∫—É, —É –ø–µ—Ä—ñ–æ–¥ –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ –¥–ª—è –£–∫—Ä–∞—ó–Ω–∏. –ó–∞—Å–Ω–æ–≤–Ω–∏—Ü—è, –í—ñ—Ç–∞, –ø—Ä–∏–π–º–∞–ª–∞ —Ç–∞ –¥–æ–ø–æ–º–∞–≥–∞–ª–∞ –ø–µ—Ä–µ—Å–µ–ª–µ–Ω—Ü—è–º —ñ–∑ —Ç–∏–º—á–∞—Å–æ–≤–æ –æ–∫—É–ø–æ–≤–∞–Ω–∏—Ö —Ç–µ—Ä–∏—Ç–æ—Ä—ñ–π, —Ä–æ–∑–º—ñ—â—É—é—á–∏ —ó—Ö —É –ö–∏—î–≤—ñ —Ç–∞ –°–ª–∞–≤—É—Ç–∏—á—ñ. –ü–µ—Ä—à—ñ –±–ª–µ–∫–∞—É—Ç–∏ –ø—ñ–¥—à—Ç–æ–≤—Ö–Ω—É–ª–∏ –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —è—Å–∫—Ä–∞–≤–∏—Ö, –∫–æ–ª—å–æ—Ä–æ–≤–∏—Ö —Å–≤—ñ—á–æ–∫, —â–æ –Ω–µ —Ç—ñ–ª—å–∫–∏ –¥–∞—Ä—É—é—Ç—å —Å–≤—ñ—Ç–ª–æ, –∞–ª–µ –π —Ç–µ–ø–ª–æ—Ç—É —Ç–∞ –Ω–∞–¥—ñ—é –≤ —Ç–µ–º–Ω—ñ —á–∞—Å–∏. –¶–µ–π –±—Ä–µ–Ω–¥ —Å–∏–º–≤–æ–ª—ñ–∑—É—î –∞–¥–∞–ø—Ç–∞—Ü—ñ—é —Ç–∞ —Ç–≤–æ—Ä—á—ñ—Å—Ç—å –Ω–∞–≤—ñ—Ç—å —É –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∏—Ö —É–º–æ–≤–∞—Ö.\n\n'''
            '''üîπ*GST candles*: –ë—Ä–µ–Ω–¥ GST candles —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¢–µ—Ç—è–Ω–æ—é —Ç–∞ –°–æ—Ñ—ñ—î—é –•–ª–µ–≤–∏—á —É 2022 —Ä–æ—Ü—ñ. –í—ñ–Ω –≤–∏—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–º –¥–∏–∑–∞–π–Ω–æ–º —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ–∫–æ–ª–æ–≥—ñ—á–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –¥–ª—è —Å–≤–æ—ó—Ö —Å–≤—ñ—á–æ–∫. GST candles –ø–æ—î–¥–Ω—É—î —Å—Ç–∏–ª—å —Ç–∞ —Ç—É—Ä–±–æ—Ç—É –ø—Ä–æ –¥–æ–≤–∫—ñ–ª–ª—è, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –µ—Å—Ç–µ—Ç–∏—á–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è –¥–ª—è –¥–æ–º—É —Ç–∞ —Å—Ç–≤–æ—Ä—é—é—á–∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∑–∞—Ç–∏—à–∫—É. –á—Ö–Ω—ñ –≤–∏—Ä–æ–±–∏ —î —á—É–¥–æ–≤–∏–º –ø–æ—î–¥–Ω–∞–Ω–Ω—è–º —Å—É—á–∞—Å–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É —Ç–∞ –µ—Ç–∏—á–Ω–æ–≥–æ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞.\n\n'''
            '''üîπ*ZUKHVALO*: ZUKHVALO ‚Äî —Ç—É—Ç –º–æ–∂–Ω–∞ –≤—ñ–¥–Ω–∞–π—Ç–∏ —Ç–∏—à—É. –ö–æ–∂–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –¥–æ–ø–æ–º–∞–≥–∞—î —É–ø–æ–≤—ñ–ª—å–Ω–∏—Ç–∏ —Ä–∏—Ç–º, –∑–∞—Å–ø–æ–∫–æ—ó—Ç–∏ –¥—É–º–∫–∏ –π –Ω–∞—Å–æ–ª–æ–¥–∏—Ç–∏—Å—è –º–æ–º–µ–Ω—Ç–æ–º —Ç–∏—à—ñ. –ú–∞–ª—é—é—á–∏, –≤–∏ –ø–æ—Ä–∏–Ω–∞—î—Ç–µ –≤ —Å–≤—ñ—Ç —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Ç—Ä–∞–¥–∏—Ü—ñ–π —ñ —Ç–µ–ø–ª–∏—Ö —Å–ø–æ–≥–∞–¥—ñ–≤ –∑ –¥–∏—Ç–∏–Ω—Å—Ç–≤–∞, —è–∫—ñ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å —É –±–µ–∑—Ç—É—Ä–±–æ—Ç–Ω—ñ —á–∞—Å–∏.\n\n'''
            '''üîπ*Hutsul Authentica*: Hutsul Authentica ‚Äî –±—Ä–µ–Ω–¥, –∑–∞—Å–Ω–æ–≤–∞–Ω–∏–π –º–∞–π—Å—Ç—Ä–∞–º–∏, —è–∫—ñ –≤—ñ–¥–¥–∞–Ω—ñ –º–∏—Å—Ç–µ—Ü—Ç–≤—É –ì—É—Ü—É–ª—å—â–∏–Ω–∏ —Ç–∞ –ø—Ä–∞–≥–Ω—É—Ç—å –∑–±–µ—Ä–µ–≥—Ç–∏ —ó—ó –±–∞–≥–∞—Ç–æ–≤—ñ–∫–æ–≤—ñ —Ç—Ä–∞–¥–∏—Ü—ñ—ó. –í–æ–Ω–∏ –≤—ñ–¥–Ω–æ–≤–ª—é—é—Ç—å –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–∞–≤–Ω—ñ –ø—Ä–∏–π–æ–º–∏ —Ç–∞ —Å—Ç–∏–ª—ñ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ñ –¥–ª—è –≥—ñ—Ä—Å—å–∫–æ–≥–æ —Ä–µ–≥—ñ–æ–Ω—É. –ú—ñ—Å—ñ—è –±—Ä–µ–Ω–¥—É ‚Äî –≤—ñ–¥—Ä–æ–¥–∏—Ç–∏ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∏–∫–ª–∞–¥–Ω–µ –º–∏—Å—Ç–µ—Ü—Ç–≤–æ –≥—É—Ü—É–ª—ñ–≤, –ø–æ–ø—É–ª—è—Ä–∏–∑—É–≤–∞—Ç–∏ –π–æ–≥–æ —Å–µ—Ä–µ–¥ –Ω–æ–≤–∏—Ö –ø–æ–∫–æ–ª—ñ–Ω—å —Ç–∞ –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è —Å–≤—ñ—Ç—É. –ö–æ–∂–µ–Ω –≤–∏—Ä—ñ–± Hutsul Authentica —î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è–º –±–∞–≥–∞—Ç–æ—ó –∫—É–ª—å—Ç—É—Ä–∏ —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó –ì—É—Ü—É–ª—å—â–∏–Ω–∏.\n\n'''
            "‚ù§Ô∏è–ö–æ–∂–µ–Ω –ø–∞—Ä—Ç–Ω–µ—Ä ‚Äî —Ü–µ —â–µ –æ–¥–∏–Ω –∫—Ä–æ–∫ –¥–æ –ø–µ—Ä–µ–º–æ–≥–∏!\n\n"
        ),
        parse_mode="Markdown"
    )
# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è "–î–æ–ª—É—á–∏—Ç–∏—Å—å –¥–æ –ø—ñ–¥—Å–∏–ª–µ–Ω–Ω—è –∑–±–æ—Ä—É"
join_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="‚ú® –°—Ç–∞–≤–∞–π —á–∞—Å—Ç–∏–Ω–æ—é –¥–∏–≤–∞! ‚ú®")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è –≤–∏–±–æ—Ä—É "–Ø–Ω–≥–æ–ª" –∞–±–æ "–û–±–µ—Ä—ñ–≥"
angel_guardian_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="–Ø–Ω–≥–æ–ª"), KeyboardButton(text="–û–±–µ—Ä—ñ–≥")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

# –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "‚ú® –°—Ç–∞–≤–∞–π —á–∞—Å—Ç–∏–Ω–æ—é –¥–∏–≤–∞! ‚ú®"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\
async def choose_role(message: Message):
    await message.answer(
        text=(
            "‚ú® *–û–±–µ—Ä–∏ —Å–≤–æ—é —Ä–æ–ª—å —Ç–∞ –¥–æ–ø–æ–º–æ–∂–∏ –¥–æ—Å—è–≥—Ç–∏ –º–µ—Ç–∏:*\n\n"
            "1Ô∏è‚É£ *üïä –Ø–Ω–≥–æ–ª: –æ—á–æ–ª—å—Ç–µ —Å–≤—ñ–π –∑–±—ñ—Ä —Ç–∞ –≤–µ–¥—ñ—Ç—å —ñ–Ω—à–∏—Ö –¥–æ –±–ª–∞–≥–æ–¥—ñ–π–Ω–æ—ó –º–µ—Ç–∏*\n"
            "üîπ –ë–µ—Ä–µ –Ω–∞ —Å–µ–±–µ —Ä–æ–ª—å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞ —Ç–∞ –º–æ—Ç–∏–≤–∞—Ç–æ—Ä–∞.\n"
            "üîπ –°—Ç–≤–æ—Ä—é—î —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É —ñ –∑–±–∏—Ä–∞—î –≤—ñ–¥ 50 —Ç–∏—Å—è—á –≥—Ä–∏–≤–µ–Ω—å, –∑–∞–ª—É—á–∞—é—á–∏ —ñ–Ω—à–∏—Ö –¥–æ —É—á–∞—Å—Ç—ñ, —Å—Ç–≤–æ—Ä—é—é—á–∏ —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É –ø—ñ–¥—Å–∏–ª—é–≤–∞—á—ñ–≤.\n\n"
            "2Ô∏è‚É£ *ü™Ñ –û–±–µ—Ä—ñ–≥: –ø—ñ–¥—Ç—Ä–∏–º–∞–π—Ç–µ –æ–¥–Ω–æ–≥–æ –∑ –Ø–Ω–≥–æ–ª—ñ–≤ —Ç–∞ —Å—Ç–∞–Ω—å—Ç–µ —á–∞—Å—Ç–∏–Ω–æ—é –π–æ–≥–æ –∫–æ–º–∞–Ω–¥–∏.*\n"
            "üîπ –û–±–∏—Ä–∞—î –∫–æ–º–∞–Ω–¥—É –æ–¥–Ω–æ–≥–æ –∑ –Ø–Ω–≥–æ–ª—ñ–≤.\n"
            "üîπ –í—ñ–¥–∫—Ä–∏–≤–∞—î –¥–æ–ø–æ–º—ñ–∂–Ω—É –±–∞–Ω–∫—É –≤—ñ–¥ 1 –¥–æ 50 —Ç–∏—Å—è—á –≥—Ä–∏–≤–µ–Ω—å.\n\n"
            "–í–∏–±–µ—Ä–∏ —Å–≤–æ—é —Ä–æ–ª—å, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫–Ω–æ–ø–∫—É:"
        ),
        reply_markup=angel_guardian_keyboard,
        parse_mode="Markdown"
    )


# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è –≤–∏–±–æ—Ä—É "–Ø–Ω–≥–æ–ª" –∞–±–æ "–û–±–µ—Ä—ñ–≥"
angel_guardian_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="–Ø–Ω–≥–æ–ª"), KeyboardButton(text="–û–±–µ—Ä—ñ–≥")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

#################################################################################################–Ø–ù–ì–û–õ/////////////////
class AngelState(StatesGroup):
    select_region = State()
    input_amount = State()
    input_instagram = State()
    input_wish = State()
    upload_photo = State()
    input_jar_link = State()

async def angel_selected(message: Message, state: FSMContext):
    db = BotDB(os.getenv("DB_NAME"))
    try:
        # –û–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É –ë–î
        db.update_role(message.from_user.id, "–Ø–Ω–≥–æ–ª")
        await message.answer("üòá –¢–∏ –æ–±—Ä–∞–≤ —Ä–æ–ª—å *–Ø–Ω–≥–æ–ª–∞*! –¢–≤—ñ–π –≤–∏–±—ñ—Ä –∑–±–µ—Ä–µ–∂–µ–Ω–æ.", parse_mode="Markdown")

        # –ù–∞–¥—Å–∏–ª–∞—î–º–æ –∫–æ–Ω—Ç–∞–∫—Ç –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        admin_name = os.getenv("ADMIN_NAME")
        admin_name_2 = os.getenv("ADMIN_NAME_2")
        admin_phone = os.getenv("ADMIN_PHONE")
        admin_phone_2 = os.getenv("ADMIN_PHONE_2")

        await message.answer(
            f"‚ö† –Ø–∫—â–æ –≤–∏–Ω–∏–∫–Ω—É—Ç—å –∑–∞–ø–∏—Ç–∞–Ω–Ω—è, –∑–≤–µ—Ä—Ç–∞–π—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó:\n\n"
            f"üî∏ **{admin_name}**\n"
            f"üìû **–¢–µ–ª–µ—Ñ–æ–Ω**: {admin_phone}\n\n"
            f"üî∏ **{admin_name_2}**\n"
            f"üìû **–¢–µ–ª–µ—Ñ–æ–Ω**: {admin_phone_2}",
            parse_mode="Markdown",
            reply_markup=support_keyboard
        )

        # –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –≤–∏–±–æ—Ä—É –æ–±–ª–∞—Å—Ç—ñ
        await message.answer(
            "–û–±–µ—Ä–∏ —Å–≤–æ–≥–æ –Ø–Ω–≥–æ–ª–∞ —Å–µ—Ä–µ–¥ –æ–±–ª–∞—Å—Ç–µ–π –£–∫—Ä–∞—ó–Ω–∏, –≤–∏–±–µ—Ä–∏ —Ä—ñ–¥–Ω—É –∞–±–æ –±–ª–∏–∑—å–∫—É —Ç–≤–æ—î–º—É —Å–µ—Ä—Ü—é –æ–±–ª–∞—Å—Ç—å:",
            reply_markup=regions_keyboard
        )
        await state.set_state(AngelState.select_region)

    finally:
        db.close()

# –°–ø–∏—Å–æ–∫ –æ–±–ª–∞—Å—Ç–µ–π –£–∫—Ä–∞—ó–Ω–∏
regions = [
    "–í—ñ–Ω–Ω–∏—Ü—å–∫–∞", "–í–æ–ª–∏–Ω—Å—å–∫–∞", "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞", "–î–æ–Ω–µ—Ü—å–∫–∞", "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞",
    "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞", "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞", "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞", "–ö–∏—ó–≤—Å—å–∫–∞", "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞",
    "–õ—É–≥–∞–Ω—Å—å–∫–∞", "–õ—å–≤—ñ–≤—Å—å–∫–∞", "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞", "–û–¥–µ—Å—å–∫–∞", "–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞",
    "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞", "–°—É–º—Å—å–∫–∞", "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞", "–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞", "–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞",
    "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞", "–ß–µ—Ä–∫–∞—Å—å–∫–∞", "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞", "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞", "–ê–† –ö—Ä–∏–º"
]

region_cases = {
    "–í—ñ–Ω–Ω–∏—Ü—å–∫–∞": "–í—ñ–Ω–Ω–∏—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–í–æ–ª–∏–Ω—Å—å–∫–∞": "–í–æ–ª–∏–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞": "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–î–æ–Ω–µ—Ü—å–∫–∞": "–î–æ–Ω–µ—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞": "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞": "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞": "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞": "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ö–∏—ó–≤—Å—å–∫–∞": "–ö–∏—ó–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞": "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–õ—É–≥–∞–Ω—Å—å–∫–∞": "–õ—É–≥–∞–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–õ—å–≤—ñ–≤—Å—å–∫–∞": "–õ—å–≤—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞": "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–û–¥–µ—Å—å–∫–∞": "–û–¥–µ—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞": "–ü–æ–ª—Ç–∞–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞": "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–°—É–º—Å—å–∫–∞": "–°—É–º—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞": "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞": "–•–∞—Ä–∫—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–•–µ—Ä—Å–æ–Ω—Å—å–∫–∞": "–•–µ—Ä—Å–æ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞": "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ß–µ—Ä–∫–∞—Å—å–∫–∞": "–ß–µ—Ä–∫–∞—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞": "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞": "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ê–† –ö—Ä–∏–º": "–ê–† –ö—Ä–∏–º"
}

regions_genitive_1 = [
    "–í—ñ–Ω–Ω–∏—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–í–æ–ª–∏–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–î–æ–Ω–µ—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ó–∞–ø–æ—Ä—ñ–∑—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ö–∏—ó–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–õ—É–≥–∞–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–õ—å–≤—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–û–¥–µ—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ü–æ–ª—Ç–∞–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–†—ñ–≤–Ω–µ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–°—É–º—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–•–∞—Ä–∫—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–•–µ—Ä—Å–æ–Ω—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ",
    "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ß–µ—Ä–∫–∞—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–æ—ó –æ–±–ª–∞—Å—Ç—ñ", "–ê–† –ö—Ä–∏–º"
]

# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è –≤–∏–±–æ—Ä—É –æ–±–ª–∞—Å—Ç—ñ
regions_keyboard = ReplyKeyboardMarkup(
    keyboard=[[KeyboardButton(text=region)] for region in regions],
    resize_keyboard=True,
    one_time_keyboard=True
)

async def choose_region(message: Message, state: FSMContext):
    region = message.text  # –û—Ç—Ä–∏–º—É—î–º–æ –æ–±—Ä–∞–Ω—É –æ–±–ª–∞—Å—Ç—å
    db = BotDB(os.getenv("DB_NAME"))
    db.update_region(message.from_user.id, region)  # –û–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ª–µ region —É –ë–î
    db.close()

    # –û–Ω–æ–≤–ª—é—î–º–æ –¥–∞–Ω—ñ —Å—Ç–∞–Ω—É
    await state.update_data(region=region)

    # –í—ñ–¥–ø–æ–≤—ñ–¥—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
    await message.answer(
        f"‚ú® –Ø–Ω–≥–æ–ª *{region} –æ–±–ª–∞—Å—Ç—ñ* ‚ú®\n\n"
        f"–î—è–∫—É—î–º–æ –∑–∞ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å —Å—Ç–∞—Ç–∏ –ø—Ä–æ–≤—ñ–¥–Ω–∏–∫–æ–º –¥–æ–±—Ä–∞ —É *{region} –æ–±–ª–∞—Å—Ç—ñ*!\n"
        f"–í–∫–∞–∂—ñ—Ç—å —Å—É–º—É –∑–±–æ—Ä—É –¥–ª—è –≤–∞—à–æ–≥–æ –Ø–Ω–≥–æ–ª–∞ (50 000 ‚Äî 100 000 –≥—Ä–Ω):",
        reply_markup=ReplyKeyboardRemove(),  # –í–∏–¥–∞–ª—è—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É
        parse_mode="Markdown"
    )
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
    await state.set_state(AngelState.input_amount)

# –õ–æ–≥—ñ–∫–∞ –∑–∞–ø–∏—Ç—É –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è
async def input_amount(message: Message, state: FSMContext):
    try:
        amount = int(message.text)  # –°–ø—Ä–æ–±–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –≤–≤–µ–¥–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ —á–∏—Å–ª–æ
        if 50000 <= amount <= 100000:  # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω—É
            await state.update_data(amount=amount)  # –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—É–º—É –≤ —Å—Ç–∞–Ω—ñ
            await message.answer(
                "üìé –ù–∞–¥—ñ—à–ª–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å–≤–æ—é –±–∞–Ω–∫—É Monobank –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, https://send.monobank.ua/jar/...):",
                reply_markup=ReplyKeyboardRemove()  # –í–∏–¥–∞–ª—è—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É
            )
            await state.set_state(AngelState.input_jar_link)  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è
        else:
            await message.answer("‚ùå –°—É–º–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –º—ñ–∂ 50 000 —Ç–∞ 100 000 –≥—Ä–Ω. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")
    except ValueError:
        await message.answer("‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å —á–∏—Å–ª–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è.")

# –õ–æ–≥—ñ–∫–∞ –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ—Å–∏–ª–∞–Ω–Ω—è
async def input_jar_link(message: Message, state: FSMContext):
    jar_link = message.text
    if jar_link.startswith("https://send.monobank.ua/jar/"):  # –ü—Ä–æ—Å—Ç–∏–π –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω–∏–π —á–µ–∫
        db = BotDB(os.getenv("DB_NAME"))
        db.update_jar_link(message.from_user.id, jar_link)
        db.close()

        await state.update_data(jar_l=jar_link)
        await message.answer(
            "üì∏ –ù–∞–¥—ñ—à–ª—ñ—Ç—å —Å–≤—ñ–π Instagram –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó:"
        )
        await state.set_state(AngelState.input_instagram)
    else:
        await message.answer("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –ø–æ—Å–∏–ª–∞–Ω–Ω—è. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑.")

async def input_wish(message: Message, state: FSMContext):
    await state.update_data(instagram=message.text)
    await message.answer(
        "üéÑ –¢–≤–æ—î –†—ñ–∑–¥–≤—è–Ω–µ –±–∞–∂–∞–Ω–Ω—è üéÑ\n"
        "–©–æ –º—Ä—ñ—î—à –æ—Ç—Ä–∏–º–∞—Ç–∏ –∞–±–æ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –Ω–∞ –ù–æ–≤–∏–π —Ä—ñ–∫? –ù–∞–ø–∏—à–∏ —Å–≤–æ—ó –¥—É–º–∫–∏:"
    )
    await state.set_state(AngelState.input_wish)

async def upload_photo(message: Message, state: FSMContext):
    await state.update_data(wish=message.text)
    await message.answer("üñº –î–æ–¥–∞–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—é –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–≤–æ—î—ó –Ø–Ω–≥–æ–ª—å—Å—å–∫–æ—ó –∫–∞—Ä—Ç–∫–∏:")
    await state.set_state(AngelState.upload_photo)

async def confirm_and_save(message: Message, state: FSMContext):
    if not message.photo:
        await message.answer("‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –Ω–∞–¥—ñ—à–ª–∏ —Å–∞–º–µ —Ñ–æ—Ç–æ.")
        return

    data = await state.get_data()

    ########################################################### –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ
    local_file_path = await save_photo_locally(message, message.from_user.id)

    # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É –±–∞–∑—É –¥–∞–Ω–∏—Ö
    db = BotDB(os.getenv("DB_NAME"))
    db.save_angel_details(
        user_id=message.from_user.id,
        region=data['region'],
        amount=data['amount'],
        instagram=data['instagram'],
        wish=data['wish'],
        photo_path=local_file_path,
        jar_l=data['jar_l']
    )
    db.close()

    await message.answer(
        f"üåü –í—ñ—Ç–∞—î–º–æ! –¢–∏ ‚Äî –Ø–Ω–≥–æ–ª *{region_cases.get(data['region'], data['region'])}*.\n"
        f"–¢–≤—ñ–π –∑–±—ñ—Ä –Ω–∞ *{data['amount']} –≥—Ä–Ω* –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è, –æ—á—ñ–∫—É–π‚Ä¶",
        parse_mode="Markdown",
        reply_markup=support_keyboard  # –î–æ–¥–∞—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑ –∫–Ω–æ–ø–∫–æ—é
    )
    await state.clear()

support_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üíô–ü–Ü–î–¢–†–ò–ú–ê–¢–ò –ó–ë–Ü–†üíõ")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

async def send_payment_details_(message: Message):
    payment_details = (
        "üí≥ **–†–µ–∫–≤—ñ–∑–∏—Ç–∏ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏** üí≥\n\n"
    "**üí≥–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏ –±–∞–Ω–∫–∏**: 4441 1111 2852 4877\n"
    "**üîó–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –±–∞–Ω–∫—É**: https://send.monobank.ua/jar/7KZbgabdGK\n\n"
        "–î—è–∫—É—î–º–æ –∑–∞ –≤–∞—à—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É! üíôüíõ"
    )

    await message.answer(payment_details, parse_mode="Markdown", reply_markup=ReplyKeyboardRemove())

#################################################################################################–ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø –§–û–¢–û/////////////////
async def save_photo_locally(message: Message, user_id: int):
    # –û—Ç—Ä–∏–º—É—î–º–æ —Ñ–æ—Ç–æ –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    photo = message.photo[-1]
    file_info = await message.bot.get_file(photo.file_id)
    file_path = file_info.file_path

    # –õ–æ–∫–∞–ª—å–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ
    save_directory = "photos"
    os.makedirs(save_directory, exist_ok=True)

    # –°—Ç–≤–æ—Ä—é—î–º–æ —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É
    local_file_path = os.path.join(save_directory, f"user_{user_id}.jpg")

    # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–æ—Ç–æ
    await message.bot.download_file(file_path, local_file_path)
    return local_file_path


#################################################################################################–û–ë–ï–†–Ü–ì/////////////////
# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –¥–ª—è —Å–ø–∏—Å–∫—É –Ø–Ω–≥–æ–ª—ñ–≤
def build_angel_keyboard(angels):
    """–ë—É–¥—É—î –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑—ñ —Å–ø–∏—Å–∫–æ–º –Ø–Ω–≥–æ–ª—ñ–≤."""
    keyboard = [
        [KeyboardButton(text=f"{angel['name']} ({angel['region']})")] for angel in angels
    ]
    return ReplyKeyboardMarkup(keyboard=keyboard, resize_keyboard=True, one_time_keyboard=True)

class GuardianState(StatesGroup):
    choose_angel = State()
    input_amount = State()
    input_instagram = State()
    input_wish = State()
    upload_photo = State()

async def guardian_selected(message: Message, state: FSMContext):
    db = BotDB(os.getenv("DB_NAME"))
    try:
        # –û–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        db.update_role(message.from_user.id, "–û–±–µ—Ä—ñ–≥")
        await message.answer("üõ°Ô∏è –¢–∏ –æ–±—Ä–∞–≤ —Ä–æ–ª—å *–û–±–µ—Ä—ñ–≥*! –¢–≤—ñ–π –≤–∏–±—ñ—Ä –∑–±–µ—Ä–µ–∂–µ–Ω–æ.", parse_mode="Markdown")

        # –û—Ç—Ä–∏–º—É—î–º–æ —Å–ø–∏—Å–æ–∫ –Ø–Ω–≥–æ–ª—ñ–≤ —ñ–∑ –ë–î
        angels = db.get_angels()  # –ú–µ—Ç–æ–¥ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ø–Ω–≥–æ–ª—ñ–≤
        if not angels:
            await message.answer("‚ùå –ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –Ø–Ω–≥–æ–ª—ñ–≤ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏.")
            return

        # –ù–∞–¥—Å–∏–ª–∞—î–º–æ —Å–ø–∏—Å–æ–∫ –Ø–Ω–≥–æ–ª—ñ–≤
        await message.answer(
            "üïä *–û–±–µ—Ä–∏ –Ø–Ω–≥–æ–ª–∞, —è–∫–æ–≥–æ —Ö–æ—á–µ—à –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ üïä*\n\n"
            "–°–ø–∏—Å–æ–∫ –Ø–Ω–≥–æ–ª—ñ–≤, —è–∫—ñ –≤–∂–µ –æ—á–æ–ª–∏–ª–∏ –∑–±—ñ—Ä —É —Ä—ñ–∑–Ω–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö:",
            reply_markup=build_angel_keyboard(angels),
            parse_mode="Markdown"
        )
        await state.set_state(GuardianState.choose_angel)

    finally:
        db.close()

async def choose_angel(message: Message, state: FSMContext):
    chosen_angel = message.text  # –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ (—ñ–º'—è –Ø–Ω–≥–æ–ª–∞ —Ç–∞ –æ–±–ª–∞—Å—Ç—å)
    db = BotDB(os.getenv("DB_NAME"))
    angels = db.get_angels()
    db.close()

    # –ó–Ω–∞—Ö–æ–¥–∏–º–æ –æ–±—Ä–∞–Ω–æ–≥–æ –Ø–Ω–≥–æ–ª–∞
    angel = next((angel for angel in angels if f"{angel['name']} ({angel['region']})" == chosen_angel), None)

    if not angel:
        await message.answer("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –æ–±—Ä–∞–Ω–æ–≥–æ –Ø–Ω–≥–æ–ª–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.")
        return

    await state.update_data(
    chosen_angel={
        'name': angel['name'],
        'region': angel['region'],
        'jar_link': angel['jar_link']
    }
)
    # –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –Ø–Ω–≥–æ–ª–∞ —Ä–∞–∑–æ–º —ñ–∑ –±–∞–Ω–∫–æ—é
    await message.answer(
        f"üåü *–ö–æ–º–∞–Ω–¥–∞ –Ø–Ω–≥–æ–ª–∞ {angel['name']} —ñ–∑ {angel['region']} –æ–±–ª–∞—Å—Ç—ñ* üåü\n\n"
        f"üìé –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –±–∞–Ω–∫—É:({angel['jar_link']})\n\n"
        "üéØ –í–∫–∞–∂–∏ —Å–≤–æ—é —Ü—ñ–ª—å–æ–≤—É —Å—É–º—É –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ (1 000 ‚Äî 20 000 –≥—Ä–Ω):",
        parse_mode="Markdown",
        reply_markup=ReplyKeyboardRemove()
    )

    await state.set_state(GuardianState.input_amount)
async def input_guardian_amount(message: Message, state: FSMContext):
    try:
        amount = int(message.text)
        if 1000 <= amount <= 20000:
            await state.update_data(amount=amount)
            await message.answer("üì∏ –ù–∞–¥—ñ—à–ª–∏ —Å–≤—ñ–π Instagram –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó:")
            await state.set_state(GuardianState.input_instagram)
        else:
            await message.answer("‚ùå –°—É–º–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –º—ñ–∂ 1 000 —Ç–∞ 20 000 –≥—Ä–Ω. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑:")
    except ValueError:
        await message.answer("‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥–∏ —á–∏—Å–ª–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è (1 000 ‚Äì 20 000 –≥—Ä–Ω).")

async def input_guardian_instagram(message: Message, state: FSMContext):
    instagram = message.text
    await state.update_data(instagram=instagram)

    # –ó–∞–ø–∏—Ç –Ω–∞ —Ä—ñ–∑–¥–≤—è–Ω–µ –ø–æ–±–∞–∂–∞–Ω–Ω—è
    await message.answer(
        "üéÑ –¢–≤–æ—î –†—ñ–∑–¥–≤—è–Ω–µ –ø–æ–±–∞–∂–∞–Ω–Ω—è üéÑ\n\n"
        "–ü–æ–¥—ñ–ª–∏—Å—å –º—Ä—ñ—î—é –∞–±–æ —Ç–µ–ø–ª–∏–º –±–∞–∂–∞–Ω–Ω—è–º –Ω–∞ –ù–æ–≤–∏–π —Ä—ñ–∫:"
    )
    await state.set_state(GuardianState.input_wish)

async def input_guardian_wish(message: Message, state: FSMContext):
    wish = message.text
    await state.update_data(wish=wish)

    # –ó–∞–ø–∏—Ç –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ
    await message.answer("üñº –î–æ–¥–∞–π —Ñ–æ—Ç–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –û–±–µ—Ä–µ–≥—É:")
    await state.set_state(GuardianState.upload_photo)

async def upload_guardian_photo(message: Message, state: FSMContext, bot: Bot):
    if not message.photo:
        await message.answer("‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –Ω–∞–¥—ñ—à–ª–∏ —Å–∞–º–µ —Ñ–æ—Ç–æ.")
        return

    # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ
    photo_path = await save_photo_locally(message, message.from_user.id)

    # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑—ñ —Å—Ç–∞–Ω—É
    data = await state.get_data()

    # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É –±–∞–∑—É –¥–∞–Ω–∏—Ö
    db.save_guardian_details(
        user_id=message.from_user.id,
        chosen_angel=data['chosen_angel']['name'],  # –ü–µ—Ä–µ–¥–∞—î–º–æ —ñ–º'—è —è–Ω–≥–æ–ª–∞
        amount=data['amount'],                      # –ü–µ—Ä–µ–¥–∞—î–º–æ —Å—É–º—É
        instagram=data['instagram'],                # Instagram –æ–±–µ—Ä–µ–≥–∞
        wish=data['wish'],                          # –ü–æ–±–∞–∂–∞–Ω–Ω—è
        photo_path=photo_path,                      # –®–ª—è—Ö –¥–æ —Ñ–æ—Ç–æ
        jar_link=data['chosen_angel']['jar_link']   # –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –±–∞–Ω–∫—É
    )

    # –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
# –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
    await message.answer(
        f"üéÅ –í—ñ—Ç–∞—î–º–æ —É –∫–æ–º–∞–Ω–¥—ñ –Ø–Ω–≥–æ–ª–∞ *{data['chosen_angel']['name']} ({data['chosen_angel']['region']} –æ–±–ª–∞—Å—Ç—å)*!\n"
        f"–¢–≤—ñ–π –∑–±—ñ—Ä –Ω–∞ *{data['amount']} –≥—Ä–Ω* –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è, –æ—á—ñ–∫—É–π‚Ä¶",
        parse_mode="Markdown",
        reply_markup=support_keyboard  # –î–æ–¥–∞—î–º–æ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä—É –∑ –∫–Ω–æ–ø–∫–æ—é
    )
    await state.clear()

#################################################################################################/////////////////
# –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ –∑ –∫–Ω–æ–ø–∫–æ—é "–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏"
support_keyboard = ReplyKeyboardMarkup(
    keyboard=[
        [KeyboardButton(text="üíô–ü–Ü–î–¢–†–ò–ú–ê–¢–ò –ó–ë–Ü–†üíõ")]
    ],
    resize_keyboard=True,
    one_time_keyboard=True
)

async def send_payment_details(message: Message):
    payment_details = (
        "üí≥ **–†–µ–∫–≤—ñ–∑–∏—Ç–∏ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏** üí≥\n\n"
    "**üí≥–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏ –±–∞–Ω–∫–∏**: 4441 1111 2852 4877\n"
    "**üîó–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –±–∞–Ω–∫—É**: https://send.monobank.ua/jar/7KZbgabdGK\n\n"
        "–î—è–∫—É—î–º–æ –∑–∞ –≤–∞—à—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É! üíôüíõ"
    )

    await message.answer(payment_details, parse_mode="Markdown", reply_markup=ReplyKeyboardRemove())
